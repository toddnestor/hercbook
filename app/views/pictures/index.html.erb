<%= page_header do %>
  <% if signed_in? && current_user == @user %>
    <%= link_to 'Add Picture', new_album_picture_path(current_user, @album), class: 'btn pull-right btn-primary' %>
  <% end %>
  <h1><%= @album.title %></h1>
<% end %>

<div class="col-md-12">
  <div class="row">
    <% @pictures.each do |picture| %>
      <div class="col-sm-4 col-md-3">
        <div class="thumbnail" style="height: 438px; width: 252px;">
          <%= link_to image_tag(picture.asset.url(:small)), album_picture_path(@user, @album, picture) %>
          <div class="caption">
            <h3>
              <% if picture.caption? %>
                <%= picture.caption %>
              <% else %>
                No Caption
              <% end %>
            </h3>
            <p><%= link_to 'View full size', album_picture_path(@user, @album, picture), class: "btn btn-primary", role: "button" %></p>
            
            <% if can_edit_picture?(picture) %>
              <p><%= link_to 'Edit', edit_album_picture_path(@album, picture), class: "btn btn-primary", role: "button" %></p>
              <p><%= link_to 'Delete', album_picture_path(@album, picture), method: :delete, data: {confirm: "Are you sure you want to delete this picture?" }, class: "btn btn-danger", role: "button" %></p>
            <% end %>
            
          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>
<%= simple_form_for(@comment, html: {class: "well", role: "form", multipart: true}) do |f| %>
<% @comments = Comment.where("parent_type = 'album' AND parent_id = " + @album.id.to_s).order("created_at") %>
<ul class="media-list">
<% @comments.each do |comment| %>
  <li class="media">
    <%= avatar_profile_link comment.user, {class: 'img-circle pull-left', width: '30px', height: '30px'} %>
    <div class="media-body">
      <h5 class="media-heading">
        <%= link_to comment.user.full_name, profile_path(comment.user) %>
        <% if User.online.include?(comment.user) %>
          <span style="color: #29aa09;">Online</span>
        <% end %>
      </h5>
      <%= replace_smilies(comment.content.html_safe) %>
      <p><small><%= time_ago_in_words(comment.created_at) %> ago</small></p>
    </div>
  </li>
  <hr style="margin-top: 2px; margin-bottom: 2px;">
<% end %>
</ul>
<%= f.error_notification %>

<div class="form-inputs">

<%= f.input :parent_type, as: :hidden, input_html: {value: 'album'} %>
<%= f.input :parent_id, as: :hidden, input_html: {value: @album.id} %>
<%= f.input :content, label: false, input_html: {class: 'form-control', placeholder: "Add a comment..."} %>

</div>

<div class="form-actions">
<%= button_tag(type: 'submit', class: "btn btn-success") do %>
  Add Comment
<% end %>
</div>
<% end %>