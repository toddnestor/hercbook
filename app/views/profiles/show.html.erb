<div class="page-header">
  <h1><%= avatar_profile_link @user, {class: 'img-circle'} %><%= @user.full_name %></h1>
  <% if User.online.include?(@user) %>
    <h4 style="color: #29aa09;">Online</h4>
  <% else %>
    <h4 style="color: #999;">Offline</h4>
  <% end %>
</div>

<% if signed_in? %>
  <div>
    <div id="friend-status<%= @user.profile_name %>" style="margin-bottom: 10px; float: left; margin-right: 10px;">
      
      <% if @user != current_user %>
        <% if current_user.friends.include?(@user) %>
          <%= link_to "Destroy Friendship", destroy_user_friendship_path(@user.user_friendship_number(current_user)), class: 'btn btn-danger', id: 'add-friendship', data: { friend_id: @user.to_param, friendship_id: @user.user_friendship_number(current_user), action: 'cancel' } %>
        <% elsif current_user.pending_friends.include?(@user) %>
          <%= link_to "Cancel Friend Request", destroy_user_friendship_path(@user.user_friendship_number(current_user)), class: 'btn btn-info', id: 'add-friendship', data: { friend_id: @user.to_param, friendship_id: @user.user_friendship_number(current_user), action: 'cancel' } %>
        <% elsif current_user.requested_friends.include?(@user) %>
          <%= link_to "Accept Friendship", accept_user_friendship_path(@user.user_friendship_number(current_user)), class: 'btn btn-warning', id: 'add-friendship', data: { friend_id: @user.to_param, friendship_id: @user.user_friendship_number(current_user), action: 'accept' } %>
        <% elsif current_user.blocked_friends.include?(@user) %>
          <%= link_to "Unblock User", destroy_user_friendship_path(@user.user_friendship_number(current_user)), class: 'btn btn-success', id: 'add-friendship', data: { friend_id: @user.to_param, friendship_id: @user.user_friendship_number(current_user), action: 'cancel' } %>
        <% else %>
          <%= link_to "Add Friend", new_user_friendship_path(friend_id: @user), class: 'btn btn-primary', id: 'add-friendship', data: { friend_id: @user.to_param, action: 'add' } %>
        <% end %>
      <% else %>
        <%= link_to "Edit Your Profile", edit_user_registration_path, class: 'btn btn-primary' %>
      <% end %>
    </div>
  <% end %>
    <div>
      <%= link_to "Albums", albums_path(@user), class: 'btn btn-success' %>
    </div>
  </div>
<% if @statuses && (current_user.friends.include?(@user) || @user == current_user) %>
  <% @statuses.each do |status| %>
    <div class="well status">
      <p><%= status.content %></p>
      <%= image_link_to_status(status) %>
      <hr />
        <div class="meta">
            <%= link_to time_ago_in_words(status.created_at).concat(" ago"), status %>
            <span class="admin">
            <% if status.user_id == current_user.id %>
                | <%= link_to "Edit", edit_status_path(status) %> |
                <%= link_to "Delete", status, method: :delete, data: { confirm: "Are you sure you want to delete this status for " + status.user.full_name + "?" } %>
            <% end %>
            </span>
        </div>
    </div>
  <% end %>
<% end %>
